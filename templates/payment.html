{% load static %}
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="{% static 'main.css' %}">
  </head>
  <body>
    <div class="bg-light py-3 px-5 d-flex">
      <a class="text-decoration-none" href="{% url 'home' %}"><h4 class="mx-3 text-success">UnitedHands</h4></a>
      <div class="d-flex ms-auto me-3">
        <a class="text-decoration-none text-primary  " href="{% url 'home' %}"><h5>Home</h5></a>
        <a class="text-decoration-none text-primary  ms-4" href="{% url 'payment' %}"><h5>Donate</h5></a>
      </div>
    </div>
	  <div class="container">
      <h1 class="text-center my-2">Make Donation</h1>
      <div class="my-5 d-flex flex-column justify-content-center text-center align-items-center">
        <input type="text" class="form-control w-50 my-3" id="name" name="name"  placeholder="Enter Your Name" >
        <input type="email" class="form-control w-50 my-2 " id="email" name="email"  placeholder="Enter Your Email" >
        <input type="number" class="form-control w-50 my-2 " id="phone" name="phone"  placeholder="Enter Your Phone Number" >
        <input type="number" class="form-control w-50 mt-2 mb-5" id="amount" name="amount" step="0.1" min="1" placeholder="Enter Amount" >
      
        <div id="paypal-button-container" class="w-50"></div>  
    </div>
    
    

 
	</div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
     <!-- Include the PayPal JavaScript SDK -->
     <script src="https://www.paypal.com/sdk/js?client-id=AbDZTbjmkRYBygiGEBrt3Yh3_BG3Fl4brLEcGOtS6EhU6r8a_rVs30fELfsVrrlv9nm-VJAeKWPDn5U4"></script>

     <script>
      paypal.Buttons({
        createOrder: function(data, actions) {
          var amountValue = document.getElementById('amount').value;
          return actions.order.create({
            purchase_units: [{
              amount: {
                value: amountValue // Replace this with the amount you want to charge
              }
            }]
          });
        },
        onApprove: function(data, actions) {
          return actions.order.capture().then(function(details) {
            // Send the transaction details to your Django view for saving
            
            var payer_name = document.getElementById('name').value;
            var payer_email = document.getElementById('email').value;
            var payer_phone = document.getElementById('phone').value;
            var formData = new FormData();
           
            formData.append('amount', details.purchase_units[0].amount.value);
            formData.append('payer_name', payer_name);
            formData.append('payer_email', payer_email);
            formData.append('payer_phone', payer_phone);
            formData.append('orderID', data.orderID);
    
            fetch('/payment/paypal-payment/', {
              method: 'POST',
              body: formData
            }).then(function(response) {
              if (response.ok) {
                alert('Transaction completed by ' + payer_name);
                // Handle any further actions you want to take after successful payment
              } else {
                alert('Transaction failed!');
              }
            });
          });
        }
      }).render('#paypal-button-container');
    </script>
     
  
  </body>
</html>


